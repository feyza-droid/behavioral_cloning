import torch
import numpy as np
from network import MyNetwork

model = MyNetwork(41, 2) #state and action shape

model.load_state_dict(torch.load("bc_idm")) #torch.load(PATH)
model.eval()

state = np.array([
    [0.0000, 0.0000, 0.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
    1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000,
    1.0000, 1.0000, 1.0000, 0.0490, 0.0490, 0.0506, 0.0539, 0.0597, 0.0692,
    0.0852, 0.1152, 0.1855, 0.4880, 0.6919, 0.1923, 0.1160, 0.0851, 0.0690,
    0.0596, 0.0539, 0.0506, 0.0490, 0.0000],
    [-7.3237e-07,  2.1704e-09,  0.0000e+00,  1.0000e+00,  1.0000e+00,
    1.0000e+00,  1.0000e+00,  1.0000e+00,  1.0000e+00,  1.0000e+00,
    1.0000e+00,  1.0000e+00,  1.0000e+00,  1.0000e+00,  1.0000e+00,
    1.0000e+00,  1.0000e+00,  1.0000e+00,  1.0000e+00,  1.0000e+00,
    1.0000e+00,  4.9037e-02,  4.9037e-02,  5.0580e-02,  5.3917e-02,
    5.9677e-02,  6.9167e-02,  8.5203e-02,  1.1520e-01,  1.8547e-01,
    4.8803e-01,  6.9190e-01,  1.9232e-01,  1.1600e-01,  8.5132e-02,
    6.9002e-02,  5.9593e-02,  5.3883e-02,  5.0567e-02,  4.9036e-02,
    2.4777e-04]])

state = torch.from_numpy(state).float()

action = model(state)
print(action)